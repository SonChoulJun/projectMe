<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 					
<mapper namespace="UserMapper">

	
	<resultMap type="user" id="userSelectMap">

	    <result property="userNo" column="USER_NO" jdbcType="NUMERIC" />
		<result property="userId" column="USERID" jdbcType="VARCHAR"/>
		<result property="userName" column="USER_NM" jdbcType="VARCHAR"/>
		<result property="password" column="PASSWORD" jdbcType="VARCHAR"/>
		<result property="phone" column="PHONE" jdbcType="VARCHAR"/>
		<result property="activity" column="ACTIVITY" jdbcType="CHAR"/>
		<result property="joinDate" column="JOIN_DATE" jdbcType="DATE"/>
		<result property="alramActivity" column="ALRAM_ACTIVITY" jdbcType="CHAR"/>
		<result property="alramCount" column="ALRAM_COUNT" jdbcType="NUMERIC"/>
	</resultMap>
	
	
	
	
	<select id="getAlram"     parameterType="int"  resultType="alram">
        
		select A.ALRAM_NO as alramNo, A.SEND_ID as sendId, A.TEXT as text, A.ALTAM_DATE as alarmDate
		from BT_USER U, BT_PHOTO_FOLDER P, BT_ALRAM A
		WHERE U.USER_NO = A.USER_NO AND P.PF_NO = A.PF_NO AND U.USER_NO = #{value}
		ORDER BY A.ALTAM_DATE
	</select>
	
	
	 <select id="findUser"     parameterType="User" resultMap="userSelectMap" >
        SELECT
        *
        FROM BT_USER
        WHERE USERID=#{userId} AND password=#{password}
     </select>
	

	<select id="getUser" parameterType="string" resultMap="userSelectMap">
        select  
        USER_NO ,USERID, USER_NM, PASSWORD, PHONE, ACTIVITY, JOIN_DATE, ALRAM_ACTIVITY, ALRAM_COUNT

        FROM     bt_user
        where userId=#{value}
     </select>


     <delete id="removeUser"        parameterType="String">
        DELETE
        FROM BT_USER
        WHERE USERID = #{value}
    </delete>
    


	 <insert id="addUser" parameterType="user">
    INSERT 
    INTO BT_USER(USER_NO,USERID,USER_NM,PASSWORD,PHONE,ACTIVITY,JOIN_DATE,ALRAM_ACTIVITY,ALRAM_COUNT)
    VALUES(SEQ_BT_USER_NO.nextval,
          #{userId},
          #{userName},
          #{password},
          #{phone},
          #{activity},
          sysdate,
          '0',
          0)
  </insert> 
  
  <update id="updateUser" parameterType="user">
        UPDATE bt_user 
        <set>
                                                   USER_NM = #{userName},
                                                     PHONE = #{phone},
                                                PASSWORD = #{password},
                                                JOIN_DATE= sysdate
                                                              
        </set>
        WHERE USERID = #{userId}       
    </update>
	
  <select id="getFollwerCount" parameterType="int" resultType="int">	
    select count(*) from BT_FOLLOWER where FOLLOWING_USER_NO =#{value}
  </select>
  
  <select id="getFollwingCount" parameterType="int" resultType="int">  
    select count(*) from BT_FOLLOWER where FOLLOWER_USER_NO =#{value}
  </select>

</mapper>